################################
# 
# Alicorn Events
#
################################

# Written by Tony Taylor

namespace = LIBP

# Arrival of Celestia and Luna
narrative_event = {
	id=LIBP.1
	title = "EVTNAME_LIBP_001"
	desc="EVTDESC_LIBP_001"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
		has_global_flag = Discord_exists
		e_chaos = {
			holder_scope = {
				num_of_titles = 5
			}
		}
	}
	immediate = {
		set_global_flag = Sun_and_Moon_have_come
		create_character = {
			random_traits = no
			name = "Celestia"
			dynasty = 1
			Religion = celestian
			culture = alicorn_culture
			female = yes
			age = 20
			attributes = {
				martial = 15
				diplomacy = 18
				stewardship = 18
				intrigue = 15
				learning = 16
			}
			health = 200
			fertility = 0
			trait = alicorn
			trait = grey_eminence
			trait = charitable
			trait = trusting
			trait = gregarious
		}
		new_character = {		
			wealth = 100000
			set_landed_title = k_princess_of_the_sun
		}

		create_character = {
			random_traits = no
			name = "Luna"
			dynasty = 001
			Religion = celestian
			culture = alicorn_culture
			female = yes
			age = 20
			attributes = {
				martial = 18
				diplomacy = 15
				stewardship = 15
				intrigue = 18
				learning = 16
			}
			health = 200
			fertility = 0
			trait = alicorn
			trait = elusive_shadow
			trait = zealous
			trait = honest
			trait = kind
		}
		new_character = {
			wealth = 100000
			set_landed_title = k_princess_of_the_moon
		}
	}

	option = {
		name = "Sample"
	}
}

# Luna and Celestia seek aid
character_event = {
	id=LIBP.2
	title = "EVTNAME_LIBP_002"
	desc = "EVTDESC_LIBP_002"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
		has_global_flag = Sun_and_Moon_have_come
		NOT = { has_global_flag = Discord_ousted }
		NOT = { has_landed_title = k_princess_of_the_sun }
		NOT = { has_landed_title = k_princess_of_the_moon }
		NOT = { has_landed_title = e_chaos }
		NOT = { demesne_size = 0 }
		NOT = { has_character_modifier = favor_of_the_alicorns }
		
	}
	
	mean_time_to_happen = {
		months = 120
		
		modifier = {
			factor = 0.9
			trait = zealous
		}
		modifier = {
			factor = 0.9
			demesne_size = 2
		}
		modifier = {
			factor = 0.9
			demesne_size = 3
		}
		modifier = {
			factor = 0.9
			demesne_size = 4
		}
		modifier = {
			factor = 0.9
			demesne_size = 5
		}

	}

	option = {
		name = "Of course I'll help!"
		add_character_modifier = favor_of_the_alicorns
		remove_character_modifier = spurned_the_sisters
		e_chaos = {
			holder_scope = {
				war = {
					casus_belli = tribal_invasion
					target = ROOT
					thirdparty_title = PREVPREV
				}
			}
		}
	}
	
	option = {
		name = "I can't afford to help!"
		add_character_modifier = spurned_the_sisters
	}
}
	
# Celestia and Luna decide the fate of Discord
narrative_event = {
	id=LIBP.3
	title = "EVTNAME_LIBP_003"
	desc = "EVTDESC_LIBP_003"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
		has_global_flag = Discord_exists
		has_global_flag = Sun_and_Moon_have_come
		has_landed_title = k_princess_of_the_sun
		has_global_flag = Discord_defeated

	}
	
	immediate = {
		remove_global_flag = Discord_first_war
	}

	option = {
		name = "He cannot be suffered to live among us!"
		if = {
			limit = {
				has_global_flag = Discord_massacre
			}
		}
		ai_chance = { factor = 100 }
		set_global_flag = Discord_is_stoned
		e_chaos = {
			holder_scope = {
				death = {
					death_reason = death_stoned
				}
			}
		}
	}
	
	option = {
		name = "We may yet redeem him"
		set_global_flag = Discord_rehabilitation
		e_chaos = {
			holder_scope = {
				set_defacto_liege = k_princess_of_the_moon
			}
		}
	}
}
	
	
# Celestia/Luna become popes
narrative_event = {
	id=LIBP.4
	title = "EVTNAME_LIBP_004"
	desc = "EVTDESC_LIBP_004"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
		has_landed_title = k_princess_of_the_sun
		NOT = { has_global_flag = Discord_first_war }
		NOT = { has_global_flag = ponyism_formed }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "Sample"
	    set_landed_title = k_equestria
		set_parent_religion = { religion = unicorn_religion parent = celestian }
		set_parent_religion = { religion = pegasi_religion parent = celestian }
		set_parent_religion = { religion = earth_religion parent = celestian }
		set_global_flag = ponyism_formed
		hidden_tooltip = {
			any_playable_ruler = {
				limit = { 
					OR = {
						religion = unicorn_religion
						religion = pegasi_religion
						religion = earth_religion
					}
					controls_religion = no
				}
				narrative_event = { id = LIBP.222 }
			}
		}
	}
}

# Convert or Not?
narrative_event = {
	id = LIBP.222
	title = LIBP.222
	desc = LIBP.222
	
	picture = GFX_evt_icon
	
	is_triggered_only = yes
	
	option = { # Yes
		name = "Sample"
		ai_chance = { factor = 95 }
		religion = celestian
		any_courtier = {
			religion = celestian
		}
		capital_scope = {
			religion = celestian
		}
	}
	option = { # No
		name = "Sample"
		ai_chance = { factor = 5 }
	}
}
	
# Luna starts getting jealous
narrative_event = {
	id = LIBP.5
	title = "EVTNAME_LIBP_005"
	desc = "EVTDESC_LIBP_005"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
	
	}
	
	mean_time_to_happen = {
		months = 24
	}
	
	immediate = {
		set_global_flag = Luna_jealous
	}
	
	option = {
		name = "Sample"
	}
}
	
# Luna becomes Nightmare Moon
narrative_event = {
	id = LIBP.6
	title = "EVTNAME_LIBP_006"
	desc = "EVTDESC_LIBP_006"
	
	picture = "GFX_evt_mongols"
	border = "GFX_event_narrative_frame_war"
	
	trigger = {
	has_global_flag = Luna_jealous
	}
	
	mean_time_to_happen = {
		months = 24
	}
	
	immediate = {
	
	}
	
	option = {
		name = "Sample"
	}
}